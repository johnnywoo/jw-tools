#!/bin/bash

if [ -f /usr/bin/edit ]; then
	# we have the local edit
	edit "$@"
	exit $?
fi

[ -z "$1" ] && exit 1

file=$1
shift

abs_file="$(readlink -f $file)"

if [[ "$abs_file" != /mnt/desktop-vps-share/* ]]; then
	sudo nano "$file" "$@"
	exit $?
fi

x='/mnt/desktop-vps-share'
remote_file="${abs_file/$x//Users/johnnywoo/vps-share}"

ssh desktop "open -a \"Sublime Text 2\" $remote_file $@"
